<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>è‹±è¯­å® ç‰© Â· å®¶åº­ç‰ˆ</title>

<style>
body{
  margin:0;
  font-family:"Comic Sans MS","PingFang SC",sans-serif;
  background:linear-gradient(#cceeff,#ffffff);
  text-align:center;
}
h1{margin:12px}

/* ====== å® ç‰© ====== */
.pet-wrap{margin:20px auto; width:220px;}
.pet{
  width:200px;height:200px;margin:auto;
  transition:transform .3s;
}
.pet.happy{transform:translateY(-6px);}
.blink{
  animation:blink 4s infinite;
}
@keyframes blink{
  0%,95%,100%{transform:scaleY(1)}
  96%,99%{transform:scaleY(0.1)}
}

/* ====== å¡ç‰‡ ====== */
.card{
  background:#fff;
  border-radius:16px;
  padding:16px;
  width:300px;
  margin:12px auto;
  box-shadow:0 4px 10px rgba(0,0,0,.1);
}
.word{font-size:32px;margin-bottom:10px}
button{
  width:100%;
  padding:12px;
  margin:6px 0;
  font-size:16px;
  border:none;
  border-radius:12px;
  background:#4caf50;
  color:#fff;
  cursor:pointer;
}
.shop-btn{background:#ff9800}
.back-btn{background:#9e9e9e}
.info{font-size:16px;margin:6px}

/* ====== è£…é¥° ====== */
.ribbon{
  position:absolute;
  top:40px;left:90px;
  font-size:28px;
}
.hidden{display:none}
</style>
</head>

<body>

<h1>ğŸ¾ æˆ‘çš„è‹±è¯­å® ç‰©</h1>

<div class="pet-wrap">
  <svg id="pet" class="pet happy" viewBox="0 0 200 200">
    <circle cx="100" cy="100" r="90" fill="#FFD966"/>
    <ellipse class="blink" cx="65" cy="80" rx="10" ry="14" fill="#000"/>
    <ellipse class="blink" cx="135" cy="80" rx="10" ry="14" fill="#000"/>
    <path d="M70 120 Q100 145 130 120" stroke="#000" stroke-width="6" fill="none"/>
  </svg>
  <div id="ribbon" class="ribbon hidden">ğŸ€</div>
</div>

<div class="info" id="statusText"></div>
<div class="info" id="scoreText"></div>
<div class="info" id="limitText"></div>

<!-- ====== å­¦ä¹ å¡ç‰‡ ====== -->
<div class="card" id="gameCard">
  <div class="word" id="word"></div>
  <button onclick="answer(true)" id="btn1"></button>
  <button onclick="answer(false)" id="btn2"></button>
  <button class="shop-btn" onclick="openShop()">ğŸª å»å•†åº—</button>
</div>

<!-- ====== å•†åŸ ====== -->
<div class="card hidden" id="shopCard">
  <h3>ğŸª å® ç‰©å•†åº—</h3>
  <button onclick="buyFood()">ğŸ– é£Ÿç‰©ï¼ˆ2 åˆ†ï¼‰</button>
  <button onclick="buyRibbon()">ğŸ€ è£…é¥°ï¼ˆ5 åˆ†ï¼‰</button>
  <button class="back-btn" onclick="closeShop()">â¬… è¿”å›</button>
</div>

<script>
/* ===== é…ç½® ===== */
const DAILY_LIMIT = 20;
const SICK_DAY = 6;

const words=[
 {w:"apple",c:"ğŸ è‹¹æœ",x:"ğŸš— æ±½è½¦"},
 {w:"dog",c:"ğŸ¶ ç‹—",x:"ğŸ± çŒ«"},
 {w:"book",c:"ğŸ“˜ ä¹¦",x:"âš½ çƒ"},
 {w:"milk",c:"ğŸ¥› ç‰›å¥¶",x:"ğŸ é¢åŒ…"}
];

/* ===== çŠ¶æ€ ===== */
let state=JSON.parse(localStorage.getItem("petState"))||{
 score:0,mood:"happy",
 learnedToday:0,lastDay:"",
 sickWeek:-1, ribbon:false
};

function save(){localStorage.setItem("petState",JSON.stringify(state))}

/* ===== æ—¶é—´ ===== */
const now=new Date();
const today=now.toDateString();
const week=getWeek(now);

if(state.lastDay!==today){
 state.learnedToday=0;
 state.lastDay=today;
}
if(now.getDay()===SICK_DAY && state.sickWeek!==week){
 state.mood="sick";
 state.sickWeek=week;
}

function getWeek(d){
 const o=new Date(d.getFullYear(),0,1);
 return Math.ceil((((d-o)/86400000)+o.getDay()+1)/7);
}

/* ===== å­¦ä¹  ===== */
let current;
function loadWord(){
 current=words[Math.floor(Math.random()*words.length)];
 word.innerText=current.w;
 btn1.innerText=current.c;
 btn2.innerText=current.x;
}

function answer(ok){
 if(state.learnedToday>=DAILY_LIMIT){
  alert("ä»Šå¤©å­¦å¤Ÿå•¦ ğŸŒ™");
  return;
 }
 if(ok){
  state.score++;
  state.learnedToday++;
  state.mood="happy";
  if(state.mood==="sick"){
    alert("ä½ æ²»å¥½äº†å® ç‰© â¤ï¸");
  }
  loadWord();
 }else{
  state.mood="hungry";
 }
 save();render();
}

/* ===== å•†åŸ ===== */
function openShop(){
 gameCard.classList.add("hidden");
 shopCard.classList.remove("hidden");
}
function closeShop(){
 shopCard.classList.add("hidden");
 gameCard.classList.remove("hidden");
}
function buyFood(){
 if(state.score<2){alert("ç§¯åˆ†ä¸å¤Ÿ ğŸ˜Š");return;}
 state.score-=2;
 state.mood="happy";
 alert("å® ç‰©åƒé¥±å•¦ï¼");
 save();render();
}
function buyRibbon(){
 if(state.score<5){alert("ç§¯åˆ†ä¸å¤Ÿ ğŸ˜Š");return;}
 state.score-=5;
 state.ribbon=true;
 alert("å® ç‰©æˆ´ä¸Šäº†æ–°è£…é¥°ï¼");
 save();render();
}

/* ===== æ˜¾ç¤º ===== */
function render(){
 scoreText.innerText="ç§¯åˆ†ï¼š"+state.score;
 limitText.innerText=`ä»Šæ—¥å­¦ä¹ ï¼š${state.learnedToday}/${DAILY_LIMIT}`;

 pet.classList.toggle("happy",state.mood==="happy");
 statusText.innerText=
  state.mood==="happy"?"çŠ¶æ€ï¼šå¼€å¿ƒ ğŸ˜Š":
  state.mood==="hungry"?"çŠ¶æ€ï¼šæœ‰ç‚¹é¥¿ ğŸ˜•":
  "çŠ¶æ€ï¼šç”Ÿç—…äº† ğŸ¤’ï¼ˆéœ€è¦å­¦ä¹ ï¼‰";

 ribbon.classList.toggle("hidden",!state.ribbon);
}

loadWord();render();save();
</script>

</body>
</html>
