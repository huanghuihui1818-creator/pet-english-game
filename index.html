<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>è‹±è¯­å°ç‹— Â· å®¶åº­ç»ˆæç‰ˆ</title>

<style>
/* ================== åŸºç¡€ ================== */
body{
  margin:0;
  font-family:"Comic Sans MS","PingFang SC",sans-serif;
  background:linear-gradient(#eef7ff,#ffffff);
  text-align:center;
}
h1{margin:8px}
.hidden{display:none}

/* ================== å°ç‹— ================== */
.pet-wrap{position:relative;margin:10px auto;width:300px}
.pet{
  width:280px;height:280px;
  transition:transform .3s;
}
.pet.happy{transform:translateY(-8px)}
.decorate{
  position:absolute;left:50%;
  transform:translateX(-50%);
  pointer-events:none;
}
.hat{top:20px;font-size:42px}
.glasses{top:120px;font-size:36px}

/* ================== å¡ç‰‡ ================== */
.card{
  background:#fff;border-radius:18px;
  padding:14px;width:420px;
  margin:10px auto;
  box-shadow:0 4px 12px rgba(0,0,0,.12);
}
button{
  width:100%;padding:12px;
  margin:6px 0;font-size:16px;
  border:none;border-radius:12px;
  background:#4caf50;color:#fff;
}
.secondary{background:#2196f3}
.shop{background:#ff9800}
.back{background:#9e9e9e}
input{font-size:18px;padding:8px;width:90%}
.info{font-size:15px;margin:4px}

/* ================== æŒ–ç©ºåŠ¨ç”» ================== */
.blank{
  display:inline-block;
  width:24px;
  border-bottom:3px solid #333;
  margin:0 2px;
  animation:pulse .8s infinite alternate;
}
@keyframes pulse{
  from{opacity:.4}
  to{opacity:1}
}
.letter-btn{
  width:auto;
  display:inline-block;
  margin:4px;
  padding:10px 14px;
}
</style>
</head>

<body>

<h1>ğŸ¶ æˆ‘çš„è‹±è¯­å°ç‹—</h1>

<!-- ============ å°ç‹—ä¸»é¡µ ============ -->
<div class="pet-wrap">
<svg id="dog" class="pet" viewBox="0 0 200 300">
  <ellipse cx="100" cy="170" rx="70" ry="80" fill="var(--dogColor,#fff)" stroke="#ccc" stroke-width="4"/>
  <circle cx="100" cy="80" r="55" fill="var(--dogColor,#fff)" stroke="#ccc" stroke-width="4"/>
  <ellipse cx="55" cy="60" rx="18" ry="30" fill="var(--dogColor,#fff)" stroke="#ccc"/>
  <ellipse cx="145" cy="60" rx="18" ry="30" fill="var(--dogColor,#fff)" stroke="#ccc"/>
  <circle cx="85" cy="80" r="6"/>
  <circle cx="115" cy="80" r="6"/>
  <circle cx="100" cy="95" r="5"/>
  <path d="M88 108 Q100 118 112 108" stroke="#000" stroke-width="3" fill="none"/>
  <line x1="80" y1="210" x2="80" y2="250" stroke="#ccc" stroke-width="6"/>
  <line x1="120" y1="210" x2="120" y2="250" stroke="#ccc" stroke-width="6"/>
</svg>
<div id="hat" class="decorate hat hidden">ğŸ©</div>
<div id="glasses" class="decorate glasses hidden">ğŸ•¶ï¸</div>
</div>

<div class="info" id="status"></div>
<div class="info" id="score"></div>

<!-- ============ ä¸»é¡µæŒ‰é’® ============ -->
<div class="card" id="home">
  <button onclick="enterStudy()">ğŸ“˜ å¼€å§‹å­¦ä¹ </button>
  <button class="shop" onclick="openShop()">ğŸª å•†åº— / è®¾è®¡</button>
</div>

<!-- ============ å­¦ä¹ åŒº ============ -->
<div class="card hidden" id="study">
  <div id="question"></div>

  <!-- é€‰æ‹©é¢˜ -->
  <div id="choices">
    <button onclick="choose(0)" id="c0"></button>
    <button onclick="choose(1)" id="c1"></button>
  </div>

  <!-- æ‹¼å†™ -->
  <div id="spell" class="hidden">
    <div id="spellHint"></div>
    <input id="spellInput" placeholder="æ‹¼å†™è‹±æ–‡">
    <button onclick="spellCheck()">æäº¤</button>
  </div>

  <!-- æŒ–ç©º -->
  <div id="blank" class="hidden">
    <div id="blankWord"></div>
    <div id="letters"></div>
  </div>

  <button class="back" onclick="backHome()">â¬… è¿”å›ä¸»é¡µ</button>
</div>

<!-- ============ å•†åº— / è®¾è®¡ ============ -->
<div class="card hidden" id="shop">
  <h3>ğŸª å•†åº— / è®¾è®¡åº“</h3>
  <button onclick="buyHat()">ğŸ© å¸½å­ï¼ˆ5åˆ†ï¼‰</button>
  <button onclick="buyGlasses()">ğŸ•¶ï¸ çœ¼é•œï¼ˆ5åˆ†ï¼‰</button>
  <button onclick="buyMedicine()">ğŸ’Š è¯ï¼ˆ10åˆ†ï¼‰</button>
  <button class="secondary" onclick="designDog()">ğŸ¨ è®¾è®¡å°ç‹—ï¼ˆ5åˆ†ï¼‰</button>
  <div>
    ğŸ¨ å°ç‹—é¢œè‰²ï¼š
    <input type="color" onchange="setColor(this.value)">
  </div>
  <button class="back" onclick="closeShop()">â¬… è¿”å›ä¸»é¡µ</button>
</div>

<script>
/* ================== å•è¯åº“ï¼ˆæ¥è‡ªç™½æ¿ï¼‰ ================== */
const words=[
["practice","ç»ƒä¹ "],["prepare","å‡†å¤‡"],["weekly","æ¯å‘¨çš„"],["schedule","å®‰æ’"],
["add","å¢åŠ "],["warm-up","çƒ­èº«"],["present","å±•ç¤º"],["start","å¼€å§‹"],
["begin","å¼€å§‹"],["country","å›½å®¶"],["brilliant","èªæ˜çš„"],["sense","æ„Ÿè§‰"],
["balance","å¹³è¡¡"],["control","æ§åˆ¶"],["complicated","å¤æ‚çš„"],["organ","å™¨å®˜"],
["without","æ²¡æœ‰"],["brain","å¤§è„‘"],["stomach","èƒƒ"],["backache","èƒŒç—›"],
["headache","å¤´ç—›"],["toothache","ç‰™ç—›"],["healthy","å¥åº·çš„"],["stretch","æ‹‰ä¼¸"],
["second","ç§’"],["breathe","å‘¼å¸"],["calm","å¹³é™çš„"],["character","è§’è‰²"],
["poor","è´«ç©·çš„"],["porridge","ç²¥"],["wild","é‡ç”Ÿçš„"],["collect","æ”¶é›†"],
["firewood","æŸ´ç«"],["knock","æ•²"],["roar","å’†å“®"],["greedy","è´ªå©ªçš„"],
["belong","å±äº"],["dangerous","å±é™©çš„"],["cough","å’³å—½"],
["hurt","å—ä¼¤"],["sore throat","å–‰å’™ç—›"],["temperature","ä½“æ¸©"],
["nature","è‡ªç„¶"],["natural","è‡ªç„¶çš„"],["unit","å•å…ƒ"],["design","è®¾è®¡"],
["place","åœ°æ–¹"],["create","åˆ›é€ "],["adventure","å†’é™©"],["map","åœ°å›¾"],
["area","åœ°åŒº"],["invent","å‘æ˜"],["tiny","å¾®å°çš„"],["large","å¤§çš„"],
["island","å²›"],["fantastic","æå¥½çš„"],["exciting","ä»¤äººå…´å¥‹çš„"],
["town","åŸé•‡"],["cry","å“­"],["leave","ç¦»å¼€"],["travel","æ—…è¡Œ"],
["until","ç›´åˆ°"],["terrible","å¯æ€•çš„"],["plan","è®¡åˆ’"],
["costume","æœè£…"],["catch","æŠ“ä½"],["palace","å®«æ®¿"],
["use","ä½¿ç”¨"],["find","æ‰¾åˆ°"],["touch","è§¦æ‘¸"],["think","æ€è€ƒ"]
].map(w=>({en:w[0],cn:w[1]}));

/* ================== çŠ¶æ€ ================== */
let state=JSON.parse(localStorage.getItem("dogUltimate"))||{
 score:0,mood:"happy",
 hat:false,glasses:false,
 color:"#ffffff"
};
function save(){localStorage.setItem("dogUltimate",JSON.stringify(state))}

/* ================== é¡µé¢åˆ‡æ¢ ================== */
function enterStudy(){
 home.classList.add("hidden");
 study.classList.remove("hidden");
 next();
}
function backHome(){
 study.classList.add("hidden");
 home.classList.remove("hidden");
}
function openShop(){
 home.classList.add("hidden");
 shop.classList.remove("hidden");
}
function closeShop(){
 shop.classList.add("hidden");
 home.classList.remove("hidden");
}

/* ================== å‡ºé¢˜ ================== */
let current,mode,dir,opts=[],blankIndex;

function next(){
 spellInput.value="";
 choices.classList.remove("hidden");
 spell.classList.add("hidden");
 blank.classList.add("hidden");

 current=words[Math.floor(Math.random()*words.length)];
 const r=Math.random();
 if(r<0.33) mode="choice";
 else if(r<0.66) mode="spell";
 else mode="blank";

 dir=Math.random()<0.5?"en2cn":"cn2en";

 if(mode==="choice"){
  const wrong=words[Math.floor(Math.random()*words.length)];
  if(dir==="en2cn"){
    question.innerText=current.en+" æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ";
    opts=[current.cn,wrong.cn];
  }else{
    question.innerText=current.cn+" ç”¨è‹±æ–‡æ€ä¹ˆè¯´ï¼Ÿ";
    opts=[current.en,wrong.en];
  }
  opts.sort(()=>Math.random()-0.5);
  c0.innerText=opts[0];
  c1.innerText=opts[1];
 }
 else if(mode==="spell"){
  choices.classList.add("hidden");
  spell.classList.remove("hidden");
  question.innerText="æ‹¼å†™å•è¯";
  spellHint.innerText="ä¸­æ–‡æç¤ºï¼š"+current.cn;
 }
 else{
  choices.classList.add("hidden");
  blank.classList.remove("hidden");
  const w=current.en;
  blankIndex=Math.floor(w.length/2);
  const display=w.split("").map((c,i)=>i===blankIndex?'<span class="blank"></span>':c).join("");
  question.innerText="è¡¥å…¨å•è¯";
  blankWord.innerHTML=display;
  letters.innerHTML="";
  const correct=w[blankIndex];
  const wrong=String.fromCharCode(97+Math.floor(Math.random()*26));
  [correct,wrong].sort(()=>Math.random()-0.5).forEach(l=>{
    const b=document.createElement("button");
    b.className="letter-btn";
    b.innerText=l;
    b.onclick=()=>checkBlank(l);
    letters.appendChild(b);
  });
 }
}

function checkSick(){
 if(state.score>30) state.mood="sick";
}

/* ================== ä½œç­” ================== */
function choose(i){
 const ans=dir==="en2cn"?current.cn:current.en;
 if(opts[i]===ans) state.score++;
 else alert("æ­£ç¡®ç­”æ¡ˆï¼š"+ans);
 checkSick();save();render();next();
}
function spellCheck(){
 if(spellInput.value.trim().toLowerCase()===current.en.toLowerCase()) state.score++;
 else alert("æ­£ç¡®æ‹¼å†™ï¼š"+current.en);
 checkSick();save();render();next();
}
function checkBlank(l){
 if(l===current.en[blankIndex]) state.score++;
 else alert("æ­£ç¡®å­—æ¯ï¼š"+current.en[blankIndex]);
 checkSick();save();render();next();
}

/* ================== å•†åº— ================== */
function buyHat(){if(state.score>=5){state.score-=5;state.hat=true;save();render()}}
function buyGlasses(){if(state.score>=5){state.score-=5;state.glasses=true;save();render()}}
function buyMedicine(){
 if(state.mood!=="sick"){alert("ç°åœ¨ä¸éœ€è¦åƒè¯");return;}
 if(state.score>=10){state.score-=10;state.mood="happy";save();render()}
}
function designDog(){
 if(state.score<5){alert("ç§¯åˆ†ä¸å¤Ÿ");return;}
 state.score-=5;
 state.color="#"+Math.floor(Math.random()*16777215).toString(16);
 save();render();
}
function setColor(c){state.color=c;save();render()}

/* ================== æ¸²æŸ“ ================== */
function render(){
 score.innerText="ç§¯åˆ†ï¼š"+state.score;
 status.innerText=
  state.mood==="happy"?"çŠ¶æ€ï¼šå¼€å¿ƒ ğŸ˜Š":
  "çŠ¶æ€ï¼šç”Ÿç—…äº† ğŸ¤’ éœ€è¦ğŸ’Š";
 dog.style.setProperty("--dogColor",state.color);
 dog.classList.toggle("happy",state.mood==="happy");
 hat.classList.toggle("hidden",!state.hat);
 glasses.classList.toggle("hidden",!state.glasses);
}
render();save();
</script>

</body>
</html>
