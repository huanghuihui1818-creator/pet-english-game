<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è‹±è¯­å°ç‹— Â· å®¶åº­ç»ˆæç‰ˆ</title>

<style>
body{
  margin:0;
  font-family:"Comic Sans MS","PingFang SC",sans-serif;
  background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
  min-height:100vh;
  text-align:center;
  padding:20px 0;
}
h1{margin:8px;color:#fff;text-shadow:2px 2px 4px rgba(0,0,0,0.3)}
.hidden{display:none!important}

/* ===== å¡ç‰‡ ===== */
.card{
  background:#fff;border-radius:18px;
  padding:20px;max-width:440px;
  margin:10px auto;
  box-shadow:0 8px 24px rgba(0,0,0,.2);
}
button{
  width:100%;padding:14px;
  margin:6px 0;font-size:16px;
  border:none;border-radius:12px;
  background:#4caf50;color:#fff;
  cursor:pointer;
  transition:all 0.3s;
  font-weight:bold;
}
button:hover{transform:translateY(-2px)}
.secondary{background:#2196f3}
.shop{background:#ff9800}
.back{background:#9e9e9e}
.design{background:#e91e63}
.achievement{background:#9c27b0}
input[type=text]{width:90%;padding:10px}

/* ===== å°ç‹— ===== */
.pet-wrap{margin:20px auto;width:300px}
.pet{width:260px;height:340px;transition:.3s}
.pet.happy{transform:translateY(-8px)}

.blank{
  display:inline-block;width:24px;
  border-bottom:3px solid #333;
  animation:pulse .8s infinite alternate;
}
@keyframes pulse{from{opacity:.4}to{opacity:1}}
.letter-btn{padding:10px 16px;margin:4px}
</style>
</head>

<body>

<h1>ğŸ¶ æˆ‘çš„è‹±è¯­å°ç‹—</h1>

<!-- ===== å°ç‹— ===== -->
<div class="pet-wrap">
<svg id="dog" class="pet" viewBox="0 0 200 300">
  <ellipse cx="100" cy="180" rx="65" ry="85" fill="var(--dogColor,#fff)" stroke="#888"/>
  <circle cx="100" cy="90" r="55" fill="var(--dogColor,#fff)" stroke="#888"/>
  <ellipse cx="55" cy="65" rx="18" ry="35" fill="var(--dogColor,#fff)" stroke="#888"/>
  <ellipse cx="145" cy="65" rx="18" ry="35" fill="var(--dogColor,#fff)" stroke="#888"/>
  <circle cx="85" cy="95" r="6"/>
  <circle cx="115" cy="95" r="6"/>
  <circle cx="100" cy="110" r="5"/>
</svg>
</div>

<div id="status"></div>
<div id="score"></div>

<!-- ===== ä¸»é¡µ ===== -->
<div class="card" id="home">
  <button onclick="enterStudy()">ğŸ“˜ å­¦ä¹ </button>
  <button class="secondary" onclick="enterCheckup()">ğŸ¥ ä½“æ£€</button>
  <button onclick="enterPK()">âš”ï¸ PK</button>
  <button class="shop" onclick="openShop()">ğŸ’Š è¯å“å•†åº—</button>
</div>

<!-- ===== ç­”é¢˜åŒº ===== -->
<div class="card hidden" id="quiz">
  <div id="quizTitle" style="font-size:18px;font-weight:bold"></div>
  <div id="question" style="margin:12px 0"></div>

  <div id="choices">
    <button onclick="choose(0)" id="c0"></button>
    <button onclick="choose(1)" id="c1"></button>
  </div>

  <div id="spell" class="hidden">
    <div id="spellHint"></div>
    <input id="spellInput">
    <button onclick="spellCheck()">æäº¤</button>
  </div>

  <div id="blank" class="hidden">
    <div id="blankWord"></div>
    <div id="letters"></div>
  </div>

  <button class="back" onclick="backHome()">è¿”å›</button>
</div>

<!-- ===== PK ===== -->
<div class="card hidden" id="pkMode">
  <h3>âš”ï¸ PK æ¨¡å¼</h3>
  <div id="pkQuestion"></div>
  <button onclick="pkChoose(0)" id="pk0"></button>
  <button onclick="pkChoose(1)" id="pk1"></button>
  <div id="pkResult"></div>
  <button class="back" onclick="backHome()">è¿”å›</button>
</div>

<!-- ===== å•†åº— ===== -->
<div class="card hidden" id="shop">
  <h3>ğŸ’Š è¯å“å•†åº—</h3>
  <button onclick="buyMedicine('headache')">å¤´ç—›è¯</button>
  <button onclick="buyMedicine('toothache')">ç‰™ç—›è¯</button>
  <button onclick="buyMedicine('stomach-ache')">èƒƒç—›è¯</button>
  <button onclick="buyMedicine('backache')">èƒŒç—›è¯</button>
  <button onclick="buyMedicine('cold')">æ„Ÿå†’è¯</button>
  <button onclick="buyMedicine('hurt')">å¤–ä¼¤è¯</button>
  <button class="back" onclick="backHome()">è¿”å›</button>
</div>

<script>
/* ===== æ•°æ® ===== */
const WORDS=[
  {en:"practice",cn:"ç»ƒä¹ "},
  {en:"prepare",cn:"å‡†å¤‡"},
  {en:"brain",cn:"å¤§è„‘"},
  {en:"healthy",cn:"å¥åº·çš„"},
  {en:"travel",cn:"æ—…è¡Œ"},
  {en:"plan",cn:"è®¡åˆ’"}
];
const DISEASES=["headache","toothache","stomach-ache","backache","cold","hurt"];

let state=JSON.parse(localStorage.getItem("DOG_OK"))||{
  score:0,mood:"healthy",disease:null
};

function save(){localStorage.setItem("DOG_OK",JSON.stringify(state))}

/* ===== é¡µé¢ ===== */
function enterStudy(){
  quizTitle.innerText="ğŸ“˜ å­¦ä¹ æ¨¡å¼";
  home.classList.add("hidden");
  quiz.classList.remove("hidden");
  next();
}
function enterCheckup(){
  quizTitle.innerText="ğŸ¥ ä½“æ£€ï¼ˆ10é¢˜ï¼‰";
  home.classList.add("hidden");
  quiz.classList.remove("hidden");
  next();
}
function backHome(){
  quiz.classList.add("hidden");
  shop.classList.add("hidden");
  pkMode.classList.add("hidden");
  home.classList.remove("hidden");
}
function openShop(){
  home.classList.add("hidden");
  shop.classList.remove("hidden");
}

/* ===== å‡ºé¢˜ ===== */
let current,opts=[],blankIdx;
function next(){
  spell.classList.add("hidden");
  blank.classList.add("hidden");
  choices.classList.remove("hidden");

  current=WORDS[Math.floor(Math.random()*WORDS.length)];
  const r=Math.random();
  if(r<0.33){
    question.innerText=`"${current.en}" æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ`;
    const wrong=WORDS[Math.floor(Math.random()*WORDS.length)].cn;
    opts=[current.cn,wrong].sort(()=>Math.random()-0.5);
    c0.innerText=opts[0];c1.innerText=opts[1];
  }else if(r<0.66){
    choices.classList.add("hidden");
    spell.classList.remove("hidden");
    question.innerText="æ‹¼å†™å•è¯";
    spellHint.innerText="ä¸­æ–‡ï¼š"+current.cn;
  }else{
    choices.classList.add("hidden");
    blank.classList.remove("hidden");
    question.innerText="è¡¥å…¨å•è¯";
    blankIdx=Math.floor(current.en.length/2);
    blankWord.innerHTML=current.en.split("").map((c,i)=>i===blankIdx?"<span class='blank'></span>":c).join("");
    letters.innerHTML="";
    const correct=current.en[blankIdx];
    const wrong=String.fromCharCode(97+Math.floor(Math.random()*26));
    [correct,wrong].sort(()=>Math.random()-0.5).forEach(l=>{
      const b=document.createElement("button");
      b.className="letter-btn";
      b.innerText=l;
      b.onclick=()=>afterAnswer(l===correct);
      letters.appendChild(b);
    });
  }
}

/* ===== ç­”é¢˜ ===== */
function afterAnswer(ok){
  if(ok) state.score++;
  else alert("æ­£ç¡®ç­”æ¡ˆï¼š"+current.en+" = "+current.cn);
  checkDisease();
  save();
  render();
  next();
}
function choose(i){
  afterAnswer(opts[i]===current.cn);
}
function spellCheck(){
  afterAnswer(spellInput.value.trim().toLowerCase()===current.en);
}

/* ===== ç”Ÿç—… ===== */
function checkDisease(){
  if(state.score>15){
    state.mood="sick";
    state.disease=DISEASES[Math.floor(Math.random()*DISEASES.length)];
  }
}
function buyMedicine(type){
  if(state.mood!=="sick"){alert("ä¸éœ€è¦åƒè¯");return;}
  if(type!==state.disease){alert("è¯ä¸å¯¹ç—‡");return;}
  if(state.score<5){alert("ç§¯åˆ†ä¸å¤Ÿ");return;}
  state.score-=5;
  state.mood="healthy";
  state.disease=null;
  save();render();
}

/* ===== PK ===== */
function enterPK(){
  home.classList.add("hidden");
  pkMode.classList.remove("hidden");
  pkNext();
}
let pkWord;
function pkNext(){
  pkWord=WORDS[Math.floor(Math.random()*WORDS.length)];
  pkQuestion.innerText=`"${pkWord.en}" æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ`;
  pk0.innerText=pkWord.cn;
  pk1.innerText="é”™è¯¯é€‰é¡¹";
}
function pkChoose(i){
  pkResult.innerText=i===0?"ä½ èµ¢äº†ï¼":"ä½ è¾“äº†";
}

/* ===== æ¸²æŸ“ ===== */
function render(){
  score.innerText="ç§¯åˆ†ï¼š"+state.score;
  status.innerText=state.mood==="healthy"?"çŠ¶æ€ï¼šå¥åº·":"çŠ¶æ€ï¼šç”Ÿç—…ï¼ˆ"+state.disease+"ï¼‰";
}
render();save();
</script>

</body>
</html>
